a.div <- aov(InvSimpson~lineage,data=df.t0.div)
summary(a.div)
#simpson
shapiro.test(df.ps.div$InvSimpson) #not fine
leveneTest(df.ps.div$InvSimpson~lineage,data=df.ps.div) #fine
a.div <- aov(InvSimpson~lineage+treat,data=df.ps.div)
summary(a.div)
gg.lin.obs.t0 <- ggplot(df.t0.div, aes(x=lineage, y=Observed,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("ASV richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.lin.obs.t0
gg.lin.obs.ps <- ggplot(df.ps.div, aes(x=lineage, y=Observed,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("ASV richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.lin.obs.ps
gg.site.obs.t0 <- ggplot(df.t0.div,aes(x=sitename,y=Observed,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("ASV richness")+
xlab("Site")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.site.obs.t0
#plotting treatment
gg.treat.obs.ps <- ggplot(df.ps.div, aes(x=treat, y=Observed,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("ASV richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.treat.obs.ps
gg.treat.lin.obs <- ggplot(df.ps.div, aes(x=treat, y=Observed,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("ASV Richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")+
facet_wrap(~lineage)
gg.treat.lin.obs
#otu richness
shapiro.test(df.t0.div$Observed) #nope
leveneTest(df.t0.div$Observed~lineage,data=df.t0.div) #fine
a.div <- aov(Observed~lineage,data=df.t0.div)
summary(a.div)
a.div <- aov(Observed~lineage+treat,data=df.ps.div)
summary(a.div)
gg.site.eve.t0 <- ggplot(df.t0.div,aes(x=sitename,y=even,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("Evenness")+
xlab("Site")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.site.eve.t0
gg.site.eve.ps <- ggplot(df.ps.div,aes(x=sitename,y=even,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("Evenness")+
xlab("Site")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.site.eve.ps
gg.lin.eve.t0 <- ggplot(df.t0.div, aes(x=lineage, y=even,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.lin.eve.t0
gg.lin.eve.ps <- ggplot(df.ps.div, aes(x=lineage, y=even,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.lin.eve.ps
#plotting treatment
gg.treat.eve.ps <- ggplot(df.ps.div, aes(x=treat, y=even,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.treat.eve.ps
gg.treat.lin.eve.ps <- ggplot(df.ps.div, aes(x=treat, y=even,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")+
facet_wrap(~lineage)
gg.treat.lin.eve.ps
#evenness
shapiro.test(df.t0.div$even) #nope
leveneTest(df.t0.div$even~lineage,data=df.t0.div) #fine
a.div <- aov(even~lineage,data=df.t0.div)
summary(a.div)
a.div <- aov(even~lineage+treat,data=df.ps.div)
summary(a.div)
# lineages
plots.lin.t0 = ggarrange(gg.lin.sh.t0, gg.lin.sim.t0, gg.lin.obs.t0, gg.lin.eve.t0, ncol=2, nrow=2)
plots.lin.t0
plots.lin.ps = ggarrange(gg.lin.sh.ps, gg.lin.sim.ps, gg.lin.obs.ps, gg.lin.eve.ps, ncol=2, nrow=2)
plots.lin.ps
getwd()
#treatment
plots.treat.ps = ggarrange(gg.treat.sh.ps, gg.treat.sim.ps, gg.treat.obs.ps, gg.treat.eve.ps, ncol=2, nrow=2)
plots.treat.ps
ggsave(plots.lin.t0, filename = "diversity_plots_lineage_clean_t0.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
ggsave(plots.lin.ps, filename = "diversity_plots_lineage_clean_prestress.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
ggsave(plots.treat.ps, filename = "diversity_plots_treat_clean_prestress.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
getwd()
ggsave(plots.treat.ps, filename = "/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/diversity_plots_treat_clean_prestress.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
ggsave(plots.lin.ps, filename = "/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/diversity_plots_lineage_clean_prestress.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
ggsave(plots.lin.t0, filename = "/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/diversity_plots_lineage_clean_t0.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
gg.lin.sh.t0 <- ggplot(df.t0.div, aes(x=lineage, y=Shannon,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Shannon index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.sh.t0
gg.lin.sh.ps <- ggplot(df.ps.div, aes(x=lineage, y=Shannon,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Shannon index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.sh.ps
gg.treat.sh.ps <- ggplot(df.ps.div, aes(x=treat, y=Shannon,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Shannon index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.treat.sh.ps
#facet wrap by lineage
gg.treat.lin.sh.ps <- ggplot(df.ps.div, aes(x=treat, y=Shannon,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Shannon index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")+
facet_wrap(~lineage)
gg.treat.lin.sh.ps
gg.lin.sim.t0 <- ggplot(df.t0.div, aes(x=lineage, y=InvSimpson,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Inv. Simpson index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.sim.t0
gg.lin.sim.ps <- ggplot(df.ps.div, aes(x=lineage, y=InvSimpson,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Inv. Simpson index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.sim.ps
gg.site.sim.t0 <- ggplot(df.t0.div,aes(x=sitename,y=InvSimpson,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("Inv. Simpson index")+
xlab("Site")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.site.sim.t0
gg.site.sim.ps <- ggplot(df.ps.div,aes(x=sitename,y=InvSimpson,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("Inv. Simpson index")+
xlab("Site")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1), axis.title.x = element_blank(), legend.position = "none")
gg.site.sim.ps
#plotting treatment
gg.treat.sim.ps <- ggplot(df.ps.div, aes(x=treat, y=InvSimpson,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Inv. Simpson index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.treat.sim.ps
gg.treat.lin.sim.ps <- ggplot(df.ps.div, aes(x=treat, y=InvSimpson,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Inv. Simpson index")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")+
facet_wrap(~lineage)
gg.treat.lin.sim.ps
gg.lin.obs.t0 <- ggplot(df.t0.div, aes(x=lineage, y=Observed,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("ASV richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.obs.t0
gg.lin.obs.ps <- ggplot(df.ps.div, aes(x=lineage, y=Observed,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("ASV richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.obs.ps
gg.site.obs.t0 <- ggplot(df.t0.div,aes(x=sitename,y=Observed,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("ASV richness")+
xlab("Site")+
theme_bw()+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.site.obs.t0
gg.site.obs.ps <- ggplot(df.ps.div,aes(x=sitename,y=Observed,color=sitename))+
geom_boxplot(outlier.shape=NA)+
scale_color_manual(values=cols_site_diverging)+
geom_jitter(alpha=0.5)+
ylab("ASV richness")+
xlab("Site")+
theme_bw()+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.site.obs.ps
#plotting treatment
gg.treat.obs.ps <- ggplot(df.ps.div, aes(x=treat, y=Observed,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("ASV richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.treat.obs.ps
gg.treat.lin.obs <- ggplot(df.ps.div, aes(x=treat, y=Observed,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("ASV Richness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")+
facet_wrap(~lineage)
gg.treat.lin.obs
gg.lin.eve.t0 <- ggplot(df.t0.div, aes(x=lineage, y=even,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.eve.t0
gg.lin.eve.ps <- ggplot(df.ps.div, aes(x=lineage, y=even,color=lineage))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_lineage)+
geom_jitter(alpha=0.5)+
xlab("Lineage")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.lin.eve.ps
#plotting treatment
gg.treat.eve.ps <- ggplot(df.ps.div, aes(x=treat, y=even,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")
gg.treat.eve.ps
gg.treat.lin.eve.ps <- ggplot(df.ps.div, aes(x=treat, y=even,color=treat))+
geom_boxplot(outlier.shape=NA)+
scale_colour_manual(values=cols_treat_reds)+
geom_jitter(alpha=0.5)+
xlab("Treatment")+
ylab("Evenness")+
theme_bw()+
#guides(color=guide_legend(title="Reef zone"),shape=guide_legend(title="Reef zone"))+
theme(axis.title.x = element_blank(), legend.position = "none")+
facet_wrap(~lineage)
gg.treat.lin.eve.ps
# lineages
plots.lin.t0 = ggarrange(gg.lin.sh.t0, gg.lin.sim.t0, gg.lin.obs.t0, gg.lin.eve.t0, ncol=2, nrow=2)
plots.lin.ps = ggarrange(gg.lin.sh.ps, gg.lin.sim.ps, gg.lin.obs.ps, gg.lin.eve.ps, ncol=2, nrow=2)
plots.lin.ps
ggsave(plots.lin.ps, filename = "/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/diversity_plots_lineage_clean_prestress.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
#treatment
plots.treat.ps = ggarrange(gg.treat.sh.ps, gg.treat.sim.ps, gg.treat.obs.ps, gg.treat.eve.ps, ncol=2, nrow=2)
plots.treat.ps
ggsave(plots.treat.ps, filename = "/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/diversity_plots_treat_clean_prestress.pdf", width=6,height=6, units=c("in"), useDingbats=FALSE)
library(rlang)
library(stringr)
library(dplyr)
library(stats)
library(ggpubr)
library(vegan)
library(cowplot)
library(tidyverse)
#library(MCMC.OTU)
#install.packages("remotes")
#remotes::install_github("Jtrachsel/funfuns")
library(funfuns)
library(phyloseq)
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/taxa2.Rdata")
#T0 phyloseq objects
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.clean.t0.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.rare.t0.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.trim.rare.t0.Rdata") # rare otu's trimmed, then rarefied (1k)
#Prestress phyloseq objects
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.clean.prestress.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.rare.prestress.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.trim.rare.prestress.Rdata") # rare otu's trimmed, then rarefied (1k)
# remove Control 2, and lineage NA's
ps.clean.t0 <- subset_samples(ps.clean.t0,(!is.na(lineage)))
ps.clean.t0 <- subset_samples(ps.clean.t0,(!is.na(treat)))
ps.clean.t0 <- subset_samples(ps.clean.t0,lineage!="L3")
ps.rare.t0 <- subset_samples(ps.rare.t0,(!is.na(lineage)))
ps.rare.t0 <- subset_samples(ps.rare.t0,(!is.na(treat)))
ps.rare.t0 <- subset_samples(ps.rare.t0,lineage!="L3")
ps.trim.rare.t0 <- subset_samples(ps.trim.rare.t0,(!is.na(lineage)))
ps.trim.rare.t0 <- subset_samples(ps.trim.rare.t0,(!is.na(treat)))
ps.trim.rare.t0 <- subset_samples(ps.trim.rare.t0,lineage!="L3")
# remove Control 2, low and high variability, and lineage NA's
ps.clean.prestress <- subset_samples(ps.clean.prestress,(!is.na(lineage)))
ps.clean.prestress <- subset_samples(ps.clean.prestress,(!is.na(treat)))
ps.clean.prestress <- subset_samples(ps.clean.prestress,(treat!="Control 2"))
ps.clean.prestress <- subset_samples(ps.clean.prestress,(treat!="Low Var"))
ps.clean.prestress <- subset_samples(ps.clean.prestress,(treat!="High Var"))
ps.clean.prestress <- subset_samples(ps.clean.prestress,lineage!="L3")
ps.rare.prestress <- subset_samples(ps.rare.prestress,(!is.na(lineage)))
ps.rare.prestress <- subset_samples(ps.rare.prestress,(!is.na(treat)))
ps.rare.prestress <- subset_samples(ps.rare.prestress,(treat!="Control 2"))
ps.rare.prestress <- subset_samples(ps.rare.prestress,(treat!="Low Var"))
ps.rare.prestress <- subset_samples(ps.rare.prestress,(treat!="High Var"))
ps.rare.prestress <- subset_samples(ps.rare.prestress,lineage!="L3")
ps.trim.rare.prestress <- subset_samples(ps.trim.rare.prestress,(!is.na(lineage)))
ps.trim.rare.prestress <- subset_samples(ps.trim.rare.prestress,(!is.na(treat)))
ps.trim.rare.prestress <- subset_samples(ps.trim.rare.prestress,(treat!="Control 2"))
ps.trim.rare.prestress <- subset_samples(ps.trim.rare.prestress,(treat!="Low Var"))
ps.trim.rare.prestress <- subset_samples(ps.trim.rare.prestress,(treat!="High Var"))
ps.trim.rare.prestress <- subset_samples(ps.trim.rare.prestress,lineage!="L3")
# make the factors of interest actual factors - T0
sample_data(ps.rare.t0)$sitename = as.factor(sample_data(ps.rare.t0)$sitename)
levels(sample_data(ps.rare.t0)$sitename)
sample_data(ps.rare.t0)$lineage = as.factor(sample_data(ps.rare.t0)$lineage)
levels(sample_data(ps.rare.t0)$lineage)
# make the factors of interest actual factors - PreStress
sample_data(ps.rare.prestress)$sitename = as.factor(sample_data(ps.rare.prestress)$sitename)
levels(sample_data(ps.rare.prestress)$sitename)
sample_data(ps.rare.prestress)$lineage = as.factor(sample_data(ps.rare.prestress)$lineage)
levels(sample_data(ps.rare.prestress)$lineage)
sample_data(ps.rare.prestress)$treat = factor(sample_data(ps.rare.prestress)$treat)
levels(sample_data(ps.rare.prestress)$treat)
# set color palettes
cols_site_diverging <- c("CI" = "#543005", "PD"= "#bf812d",  "SP"= "#dfc27d",  "BN" = "#003c30", "BS"= "#35978f", "CA"= "#80cdc1")
cols_treat_reds <- c("darkgrey", "#CC3300")
cols_lineage <- c("L1" = "#3f007d", "L2" = "#807dba")
ord.t0 <- ordinate(ps.rare.t0, "PCoA", "bray")
pcoa.lineage.t0 = plot_ordination(ps.rare.t0,ord.t0,color="lineage",shape="sitename")+
geom_point(size = 2.5, alpha=0.8)+
scale_color_manual(name="Lineage",values=cols_lineage)+
stat_ellipse(aes(group=ps.rare.t0@sam_data$lineage), type = "t", lwd = 1)+
scale_shape_manual(name="Site", values = c(15,16,17,22,21,24))+
theme_bw()
pcoa.lineage.t0
pcoa.site.t0 = plot_ordination(ps.rare.t0, ord.t0, color="sitename", shape="sitename")+
geom_point(alpha=0.8)+
scale_color_manual(name="Site",values=cols_site_diverging)+
scale_shape_manual(name="Site",values=c(15,16,17,22,21,24))+
stat_ellipse()+
theme_bw()
pcoa.site.t0
# now prestress data rarefied
ord.ps <- ordinate(ps.rare.prestress, "PCoA", "bray")
pcoa.site.ps = plot_ordination(ps.rare.prestress, ord.ps, color="sitename", shape="sitename")+
geom_point(alpha=0.8)+
scale_color_manual(name="Site",values=cols_site_diverging)+
scale_shape_manual(name="Site",values=c(15,16,17,22,21,24))+
stat_ellipse()+
theme_bw()
pcoa.lineage.ps = plot_ordination(ps.rare.prestress,ord.ps,color="lineage")+
geom_point(alpha=0.8)+
scale_color_manual(name="Lineage",values=cols_lineage)+
stat_ellipse()+
theme_bw()
gg.pcoa.all.rare.ps = ggarrange(pcoa.lineage.ps, pcoa.site.ps, pcoa.treat.ps,
labels = c("(a)","(b)","(c)"),
nrow=1,
common.legend=F,legend="none")
pcoa.treat.ps = plot_ordination(ps.rare.prestress,ord.ps, color="treat", shape="treat")+
geom_point(alpha=0.8)+
scale_color_manual(name="Treatment",values=cols_treat_reds)+
scale_shape_manual(name="Treatment",values=c(15,16))+
stat_ellipse()+
theme_bw()
gg.pcoa.all.rare.ps = ggarrange(pcoa.lineage.ps, pcoa.site.ps, pcoa.treat.ps,
labels = c("(a)","(b)","(c)"),
nrow=1,
common.legend=F,legend="none")
gg.pcoa.all.rare.ps
seq.rare.t0 <- data.frame(otu_table(ps.rare.t0))
seq.rare.t0 <- data.frame(otu_table(ps.rare.t0))
# make distance matrix with vegdist():
dist.rare.t0 <- vegdist(seq.rare.t0)
samdf.rare.t0 <- data.frame(sample_data(ps.rare.t0))
row.names(samdf.rare.t0)==row.names(seq.rare.t0)
bet.all.t0 <- betadisper(dist.rare.t0,samdf.rare.t0$sitename)
anova(bet.all.t0)
bet.all.t0 <- betadisper(dist.rare.t0,samdf.rare.t0$lineage)
anova(bet.all.t0) #p=0.851
adonis2(seq.rare.t0 ~ lineage, data=samdf.rare.t0, permutations=999)
# now prestress data
seq.rare.ps <- data.frame(otu_table(ps.rare.prestress))
# make distance matrix with vegdist():
dist.rare.ps <- vegdist(seq.rare.ps)
samdf.rare.ps <- data.frame(sample_data(ps.rare.prestress))
row.names(samdf.rare.ps)==row.names(seq.rare.ps)
bet.all.ps <- betadisper(dist.rare.ps,samdf.rare.ps$sitename)
anova(bet.all.ps)
bet.all.ps <- betadisper(dist.rare.ps,samdf.rare.ps$lineage)
anova(bet.all.ps)
bet.all.ps <- betadisper(dist.rare.ps,samdf.rare.ps$treat)
anova(bet.all.ps)
adonis2(seq.rare.ps ~ treat+lineage, data=samdf.rare.ps, permutations=999)
ps.clean.t0@sam_data
ps.clean.prestress@sam_data
ps.rare.prestress@sam_data
setwd('~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/2bRAD/')
# assembling the input table
dir="~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/2bRAD/data_files/" # path to input files
inName="mydata.noclone_k3.qopt" # name of the input file to plot, output of ngsAdmix or ADMIXTURE run
npops=as.numeric(sub(".+(\\d+)\\..+","\\1",inName))
tbl=read.table("mydata.noclone_k3.qopt")
getwd()
tbl=read.table("data_files/mydata.noclone_k3.qopt")
i2p=read.table("data_files/bam_barcode_names_tuftscustom_noclone.txt", header = TRUE)
getwd()
tbl=read.table("/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/2bRAD/data_files/mydata.noclone_k3.qopt")
i2p=read.table("/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/2bRAD/data_files/bam_barcode_names_tuftscustom_noclone.txt", header = TRUE)
#Download below from https://github.com/z0on/2bRAD_denovo/blob/master/plot_admixture_v5_function.R
source("/Users/hannahaichelman/Dropbox/BU/TVE/TVE_Github/DielTempVariability/2bRAD/plot_admixture_v5_function.R")
