date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-22 00:00:00", "2016-11-10 18:00:00")))+
theme_classic() +
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
p4_var
p5 = Tank5.3 %>%
ggplot(aes(x = DateTime_ct, y = Temp))+
geom_line(color = 'blue', lwd=1)+
ylim(26,34) +
geom_hline(aes(yintercept = 28.5), colour="grey", linetype="dashed", lwd=1) +
ggtitle("Control 2") +
xlab("Date") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
theme_classic() +
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
p5
p5_var = Tank5.3_var %>%
ggplot(aes(x = DateTime_ct, y = Temp))+
geom_line(color = 'blue', lwd=1)+
ylim(26,34) +
geom_hline(aes(yintercept = 28.5), colour="grey", linetype="dashed", lwd=1) +
ggtitle("Control 2") +
xlab("Date") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-22 00:00:00","2016-11-10 18:00:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-22 00:00:00", "2016-11-10 18:00:00")))+
theme_classic() +
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
p5_var
# ignore control 2, all data
hobo_plot <- grid.arrange(p1, p2, p3, p4, nrow = 2)
hobo_plot
#### Combine all hobo variability objects to plot ####
# with re-analysis, only including control and moderate variability treatments
all_temp = rbind(Tank1.1_all, Tank3.1_all)
head(all_temp)
str(all_temp)
all_temp$Treatment = factor(all_temp$Treatment, levels = c("Control","Mod Var"))
all_var = rbind(Tank1.1_var, Tank3.1_var)
head(all_var)
str(all_var)
all_var$Treatment = factor(all_var$Treatment, levels = c("Control","Mod Var"))
all_stress = rbind(Tank1.1_stress, Tank3.1_stress)
head(all_stress)
str(all_stress)
all_stress$Treatment = factor(all_stress$Treatment, levels = c("Control","Mod Var"))
cols_treat_reds <- c("Control" = "darkgrey", "Mod Var"="#CC3300")
# also read in extra temperature data for the moderate variability treatment for the end of the experiment
extra_data = read.csv("Temperature_Data/data_files/TankTemps/Temperature_GlassThermometer.csv")
str(extra_data)
extra_data$Day <- as.POSIXct(extra_data$DATE, format="%d-%b-%y")
extra_data_control = extra_data %>%
select(Day, Sump_1) %>%
mutate(Treatment = "Control_extra") %>%
rename("Temp" = "Sump_1")
extra_data_control = extra_data %>%
select(Day, Sump_1) %>%
mutate(Treatment = "Control_extra") %>%
dplyr::rename("Temp" = "Sump_1")
extra_data_mod = extra_data %>%
select(Day, Sump_3) %>%
mutate(Treatment = "Mod Var_extra") %>%
dplyr::rename("Temp" = "Sump_3")
extra_data_combined = rbind(extra_data_control, extra_data_mod)
extra_data_combined$Treatment = as.factor(extra_data_combined$Treatment)
str(extra_data_combined)
# plot the variability period
str(all_var)
all_var$Treatment = factor(all_var$Treatment, levels = c("Mod Var", "Control"))
all_var.plot = all_var %>%
ggplot(aes(x = DateTime_ct, y = Temp, color = Treatment))+
geom_line(aes(color = Treatment), lwd=1, alpha = 0.8)+
scale_color_manual(values = cols_treat_reds)+
ylim(26,34) +
geom_hline(aes(yintercept = 28.5), colour="grey", linetype="dashed", lwd=1) +
#ggtitle("Control 2") +
xlab("Date") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-22 00:00:00","2016-11-10 18:00:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-22 00:00:00", "2016-11-10 18:00:00")))+
theme_bw() +
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_var.plot
# plot the whole time course - figure 1C
all_temp$Treatment = factor(all_temp$Treatment, levels = c("Mod Var", "Control"))
all_temp.plot = all_temp %>%
ggplot(aes(x = DateTime_ct, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
geom_line(aes(color = Treatment), lwd=0.75)+
scale_color_manual(values = cols_treat_reds)+
#geom_hline(aes(yintercept = 28.5), colour="grey", linetype="dashed", lwd=.5) +
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot
# try to add in the extra data
all_temp_forextra = all_temp %>%
select(Day, Temp, Treatment)
all_temp_extra = melt(list(df1 = all_temp_forextra, df2 = extra_data_combined), id.vars = c("Day","Treatment"))
str(all_temp_extra)
View(all_temp_extra)
all_temp_extra2 = all_temp_extra %>%
select(Day, value, Treatment) %>%
rename("Temp" = "value")
head(all_temp_extra2)
all_temp_extra2 = all_temp_extra %>%
select(Day, value, Treatment) %>%
dplyr::rename("Temp" = "value")
head(all_temp_extra2)
all_temp_extra2$DateTime = as.POSIXct(all_temp_extra2$Day, format = )
cols_treat_reds2 <- c("Control" = "darkgrey", "Mod Var"="#CC3300", "Control_extra" = "black", "Mod Var_extra" = "darkred")
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
# plot a subset of days to zoom in and illustrate what the profiles looked like
all_temp.plot.subset = all_temp %>%
subset(DateTime_ct > "2016-10-30" & DateTime_ct <= "2016-11-02") %>%
ggplot(aes(x = DateTime_ct, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct(-Inf), xmax = as.POSIXct(Inf), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
geom_line(aes(color = Treatment), lwd=1, alpha = 1)+
scale_color_manual(values = cols_treat_reds)+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
xlab("Day") +
theme_bw() +
theme(axis.text.x = element_blank())
#theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot.subset
# plot all stress + recovery periods
all_stress.plot = all_stress %>%
ggplot(aes(x = DateTime_ct, y = Temp, color = Treatment))+
geom_line(aes(color = Treatment), lwd=1, alpha = 0.8)+
scale_color_manual(values = cols_treat_reds)+
#geom_hline(aes(yintercept = 28.5), colour="grey", linetype="dashed", lwd=1) +
xlab("Date") +
scale_x_datetime(breaks = as.POSIXct(c("2016-11-10 18:05:00","2016-11-14", "2016-11-21","2016-11-25", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-11-10 18:05:00","2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw() +
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_stress.plot
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
all_temp_extra2$Treatment
all_temp_extra2$Treatment = factor(all_temp_extra2$Treatment, levels = c("Control","Mod Var","Control_extra","Mod Var_extra"))
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
all_temp_extra2$Treatment
all_temp_extra2$Treatment
all_temp.plot = all_temp %>%
ggplot(aes(x = DateTime_ct, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
geom_line(aes(color = Treatment), lwd=0.75)+
scale_color_manual(values = cols_treat_reds)+
#geom_hline(aes(yintercept = 28.5), colour="grey", linetype="dashed", lwd=.5) +
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot
all_temp_extra2$Treatment
all_temp_extra2$Treatment = factor(all_temp_extra2$Treatment, levels = c("Control_extra","Mod Var_extra","Control","Mod Var"))
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Mod Var"])+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Control"])+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Control_extra"])+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Mod Var_extra"])+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point()+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Mod Var"])+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Control"])+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Control_extra"])+
geom_point(data = all_temp_extra2[all_temp_extra2$Treatment=="Mod Var_extra"])+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra2 %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
View(all_temp_extra2)
all_temp_extra2_Control = all_temp_extra2 %>%
select(Treatment == "Control")
all_temp_extra2_Control = all_temp_extra2 %>%
dplyr::select(Treatment == "Control")
all_temp_extra2_Control = all_temp_extra2 %>%
dplyr::filter(Treatment == "Control")
all_temp_extra2_Control = all_temp_extra2 %>%
dplyr::filter(Treatment == "Control")
all_temp_extra2_ModVar = all_temp_extra2 %>%
dplyr::filter(Treatment == "Mod Var")
all_temp_extra2_ControlExtra = all_temp_extra2 %>%
dplyr::filter(Treatment == "Control_extra")
all_temp_extra2_ModVarExtra = all_temp_extra2 %>%
dplyr::filter(Treatment == "Mod Var_extra")
all_temp_final = rbind(all_temp_extra2_ModVar, all_temp_extra2_Control, all_temp_extra2_ControlExtra, all_temp_extra2_ModVarExtra)
all_temp_extra_final = rbind(all_temp_extra2_ModVar, all_temp_extra2_Control, all_temp_extra2_ControlExtra, all_temp_extra2_ModVarExtra)
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra_final %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
cols_treat_reds2 <- c("Control" = "darkgrey", "Mod Var"="#CC3300", "Control_extra" = "black", "Mod Var_extra" = "#67000d")
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra_final %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment))+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
ggsave(all_temp.plot2,file="/Users/hannahaichelman/Dropbox/BU/TVE/TemperatureData/TankTemps/Tank_Hobo_Loggers/plots/TankTempHobo_NewTreats_CombinedWithExtraData.pdf", width=10, height=4, units=c("in"), useDingbats=FALSE)
ggsave(all_temp.plot2,file="/Users/hannahaichelman/Dropbox/BU/TVE/TemperatureData/TankTemps/Tank_Hobo_Loggers/plots/TankTempHobo_NewTreats_CombinedWithExtraData.pdf", width=12, height=6, units=c("in"), useDingbats=FALSE)
ggsave(all_temp.plot2,file="/Users/hannahaichelman/Dropbox/BU/TVE/TemperatureData/TankTemps/Tank_Hobo_Loggers/plots/TankTempHobo_NewTreats_CombinedWithExtraData.pdf", width=11, height=5, units=c("in"), useDingbats=FALSE)
ggsave(all_temp.plot2,file="/Users/hannahaichelman/Dropbox/BU/TVE/TemperatureData/TankTemps/Tank_Hobo_Loggers/plots/TankTempHobo_NewTreats_CombinedWithExtraData.pdf", width=11, height=4, units=c("in"), useDingbats=FALSE)
# make extra mod var points outlines in black
# re-level factor so that grey is on top of red
all_temp.plot2 = all_temp_extra_final %>%
ggplot(aes(x = Day, y = Temp, color = Treatment))+
annotate("rect", xmin = as.POSIXct("2016-09-07 00:00:00"), xmax = as.POSIXct("2016-09-22 00:00:00"), ymin = - Inf, ymax = Inf, fill = "gray", alpha = 0.3)+
annotate("rect", xmin = as.POSIXct("2016-09-22 00:00:00"), xmax = as.POSIXct("2016-11-10 18:00:00"), ymin = - Inf, ymax = Inf, fill = "orange", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-10 18:00:00"), xmax = as.POSIXct("2016-11-25 00:00:00"), ymin = - Inf, ymax = Inf, fill = "red4", alpha = 0.15)+
annotate("rect", xmin = as.POSIXct("2016-11-25 00:00:00"), xmax = as.POSIXct("2016-12-11 23:55:00"), ymin = - Inf, ymax = Inf, fill = "royalblue4", alpha = 0.15)+
# geom_line(aes(color = Treatment), lwd=0.75)+
geom_point(aes(color = Treatment), size = 1)+
scale_color_manual(values = cols_treat_reds2)+
xlab("Day") +
scale_x_datetime(breaks = as.POSIXct(c("2016-09-07 00:00:00", "2016-09-22 00:00:00","2016-11-10 18:00:00","2016-11-14 00:00:00","2016-11-21 00:00:00","2016-11-25 00:00:00", "2016-12-11 23:55:00")),
date_labels = "%m/%d/%y",
limits = as.POSIXct(c("2016-09-07 00:00:00", "2016-12-11 23:55:00")))+
scale_y_continuous(name = "Temperature (°C)", breaks = seq(26,33,1))+
theme_bw()+
#theme(axis.text.x = element_blank())
theme(axis.text.x = element_text(angle = 25, hjust = 1, vjust = 1))
all_temp.plot2
ggsave(all_temp.plot2,file="/Users/hannahaichelman/Dropbox/BU/TVE/TemperatureData/TankTemps/Tank_Hobo_Loggers/plots/TankTempHobo_NewTreats_CombinedWithExtraData.pdf", width=11, height=4, units=c("in"), useDingbats=FALSE)
#### Read in previously saved datafiles  - START HERE ####
# Trying now with all samples included, which was previously done following the same steps above just with all samples included
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability")
seqtab.nochim <- readRDS("16S_Microbiome/data_files/tve16s_all_seqtab.nochim_newids.rds")
taxa <- readRDS("16S_Microbiome/data_files/tve16s_all_seq_taxa_newids.rds")
#import dataframe holding sample information
samdf = read.csv("16S_Microbiome/data_files/SampleInfo.csv")
# add identifying data that includes lineage 3 - best to include from ITS2 metadata
phys_metadata = read.csv("ITS2_Symbiodiniaceae/data_files/phys_metadata_its2.csv")
ps.cleanest = readRDS("16S_Microbiome/data_files/phyloseq.cleanest.all.rds")
ps.rare.1k.t0 = readRDS("16S_Microbiome/data_files/phyloseq.t0.rarefied.1k.rds")
ps.rare.1k.prestress = readRDS("16S_Microbiome/data_files/phyloseq.prestress.rarefied.1k.rds")
load("16S_Microbiome/data_files/taxa2.Rdata")
ps.trim.t0 = readRDS("16S_Microbiome/data_files/phyloseq.cleanest.trim.t0.rds")
ps.trim.prestress = readRDS("16S_Microbiome/data_files/phyloseq.cleanest.trim.prestress.rds")
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability")
ps.trim.rare.1k.t0 = readRDS("16S_Microbiome/data_files/phyloseq.t0.trim.rarefied.1k.rds")
ps.trim.rare.1k.prestress = readRDS("16S_Microbiome/data_files/phyloseq.prestress.trim.rarefied.1k.rds")
load("16S_Microbiome/data_files/taxa2.Rdata")
# set to github repository location
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability")
#cleaned, rarefied files:
ps.rare.1k.t0 = readRDS("16S_Microbiome/data_files/phyloseq.t0.rarefied.1k.rds")
# set to github repository location
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability")
# set to github repository location
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability")
# can skip this section once you've run it once and saved output Rdata files
load("16S_Microbiome/data_files/taxa2.Rdata")
# can skip this section once you've run it once and saved output Rdata files
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/taxa2.Rdata")
#cleaned, rarefied files:
ps.rare.1k.t0 = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/phyloseq.t0.rarefied.1k.rds")
#cleaned, rarefied files:
ps.rare.1k.t0 = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.t0.rarefied.1k.rds")
ps.rare.1k.prestress = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.prestress.rarefied.1k.rds")
#cleaned, unrarefied files:
ps.clean.t0 = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.cleanest.t0.rds")
ps.clean.prestress = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.cleanest.prestress.rds")
##TRIMMED VERSIONS:
# trimmed and rarefied
ps.trim.rare.t0 = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.t0.trim.rarefied.1k.rds")
ps.trim.rare.prestress = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.prestress.trim.rarefied.1k.rds")
# just trimmed
ps.trim.t0 = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.cleanest.trim.t0.rds")
ps.trim.prestress = readRDS("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/phyloseq.cleanest.trim.prestress.rds")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/taxa2.Rdata")
# can skip to here once you have made the .Rdata files above
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.clean.t0.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.clean.prestress.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.rare.t0.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.rare.prestress.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.trim.rare.t0.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.trim.rare.prestress.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.trim.t0.Rdata")
load("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/16S_Microbiome/data_files/ps.trim.prestress.Rdata")
#packages
#install.packages("decontam")
library(decontam)
packageVersion("decontam") #‘1.10.0’ - NK's version - 1.16.0 HA's version
library(phyloseq)
library(tidyverse)
library(ggpubr)
library(dplyr)
library(viridis)
# SymPortal ITS2 DIV Analysis
# cleaned file up to remove extraneous info in the header in excel, but original file here:
# /Users/hannahaichelman/Dropbox/BU/TVE/16S_ITS2/ITS_All_Timepoints/191_20220121_03_DBV_20220121T084332.profiles.absolute.abund_and_meta.txt
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/ITS2_Symbiodiniaceae")
# SymPortal ITS2 DIV Analysis
# cleaned file up to remove extraneous info in the header in excel, but original file here:
# /Users/hannahaichelman/Dropbox/BU/TVE/16S_ITS2/ITS_All_Timepoints/191_20220121_03_DBV_20220121T084332.profiles.absolute.abund_and_meta.txt
setwd("~/Dropbox/BU/TVE/TVE_Github/DielTempVariability/ITS2_Symbiodiniaceae/")
its2_all = read.csv("data_files/SymPortal_AllTimes_RawDIVs.csv")
head(its2_all)
# read in sample data
# DIVs - this sample info includes all T0 and Pre-Stress Individuals that were run through SymPortal together.
samdf = read.csv("data_files/SampleInfo.csv")
# add identifying data that includes lineage 3
phys_metadata = read.csv("data_files/phys_metadata_its2.csv")
#### PS Object Versions ####
# T0
ps.cleanest.t0 = readRDS("/data_files/ps.its2.t0.RDS")
#### PS Object Versions ####
# T0
ps.cleanest.t0 = readRDS("data_files/ps.its2.t0.RDS")
ps.cleanest.t0.rel = readRDS("data_files/ps.its2.t0.rel.RDS")
taxa.t0 = read.csv(file = "data_files/symportal_taxa.t0.csv", header = TRUE) %>%
select(-X)
# Pre-Stress
ps.cleanest.ps = readRDS("data_files/ps.its2.prestress.RDS")
ps.cleanest.ps.rel = readRDS("data_files/ps.its2.prestress.rel.RDS")
taxa.ps = read.csv(file = "data_files/symportal_taxa.prestress.csv", header = TRUE) %>%
select(-X)
## Raw (cleaned)
ps = readRDS("data_files/ps.its2.t0.RDS")
## Relative abundance
# Report this since it is the data used for making the PCA's
ps.cleanest.rel = readRDS("data_files/ps.its2.t0.rel.RDS")
## Raw (cleaned)
ps = readRDS("data_files/ps.its2.prestress.RDS")
## Relative abundance
# Report this since it is the data used for making the PCA's
ps.cleanest.rel = readRDS("data_files/ps.its2.prestress.rel.RDS")
ps.cleanest.t0.rel = readRDS("data_files/ps.its2.t0.rel.RDS")
ps.cleanest.ps.rel = readRDS("data_files/ps.its2.prestress.rel.RDS")
## First T0
# change column names to majority its2 sequence
taxa.t0 = read.csv(file = "data_files/symportal_taxa.t0.csv", header = TRUE) %>%
select(-X)
